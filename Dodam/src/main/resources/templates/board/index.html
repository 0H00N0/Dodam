<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dodam Board UI — 정교한 프론트</title>
  <meta name="description" content="Dodam 보드(공지, 문의, FAQ, 이벤트, 커뮤니티)용 정교한 정적 UI">
  <link rel="icon" href="assets/img/favicon.svg">
  <style>
    /* 기본 리셋 */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',Pretendard,'Apple SD Gothic Neo',Helvetica,Arial,sans-serif; background:#0b0e14; color:#e6e6e6; }
    a { color: inherit; text-decoration: none; }
    /* 레이아웃 */
    .container { max-width: 1080px; margin: 0 auto; padding: 24px 16px 64px; }
    header { position: sticky; top: 0; z-index: 10; backdrop-filter: blur(8px); background: rgba(11,14,20,0.6); border-bottom: 1px solid rgba(255,255,255,0.06); }
    .nav { display:flex; align-items:center; gap:12px; padding: 12px 16px; }
    .brand { display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:0.5px; }
    .brand .logo { width:28px; height:28px; border-radius:8px; background: linear-gradient(135deg,#7bd,#7b7bff); display:inline-block; }
    .grow { flex:1; }
    .tabs { display:flex; gap:6px; flex-wrap: wrap; }
    .tab { padding:8px 12px; border:1px solid rgba(255,255,255,0.08); border-radius:12px; transition: all .15s ease; font-size: 14px; }
    .tab.active, .tab:hover { background: rgba(123, 187, 255, 0.12); border-color: rgba(123, 187, 255, 0.45); }
    main { margin-top: 16px; }
    /* 카드 */
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.08); border-radius:16px; padding:18px; box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
    .grid { display:grid; gap:16px; }
    @media (min-width: 900px) { .grid.cols-2 { grid-template-columns: 1fr 1fr; } }
    h1 { font-size: 22px; margin: 0 0 12px; font-weight: 800; }
    h2 { font-size: 18px; margin: 0 0 10px; }
    p.sub { opacity: 0.75; margin-top: 4px; }
    /* 테이블 */
    table { width:100%; border-collapse: collapse; font-size:14px; }
    th, td { text-align: left; padding: 10px 8px; border-bottom:1px dashed rgba(255,255,255,0.06); vertical-align: top; }
    thead th { position: sticky; top:0; background: rgba(11,14,20,0.9); }
    /* 폼 */
    .row { display:flex; gap:10px; align-items: center; flex-wrap: wrap; }
    label { font-size: 12px; opacity: .8; }
    input[type=text], textarea, select { background:#0f1320; color:#eaecee; border:1px solid rgba(255,255,255,0.12); border-radius: 10px; padding:10px 12px; outline: none; width:100%; }
    textarea { min-height: 120px; resize: vertical; }
    .btn { display:inline-flex; align-items: center; gap:8px; padding:9px 12px; border:1px solid rgba(255,255,255,0.14); border-radius: 10px; cursor: pointer; background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); }
    .btn.primary { border-color: rgba(123, 187, 255, 0.6); background: linear-gradient(180deg, rgba(123,187,255,0.22), rgba(123,187,255,0.05)); }
    .muted { opacity: .7; }
    .pill { font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); }
    .status { font-weight: 700; letter-spacing: 0.3px; }
    .status.PUBLISHED { color:#9be6a7; }
    .status.DRAFT { color:#e8d17d; }
    .status.ARCHIVED { color:#f19a9a; }
    footer { margin-top: 40px; opacity:.6; font-size: 13px; }
    /* 유틸 */
    .right { text-align: right; }
    .error { color: #ffb3b3; font-size: 13px; }
    .success { color: #a8f1bd; font-size: 13px; }
    .hide { display:none !important; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; background:#0f1320; border:1px solid rgba(255,255,255,0.15); padding:2px 6px; border-radius:6px; font-size:12px; }
  </style>
</head>
<body>
  <header>
    <div class="nav container">
      <div class="brand">
        <span class="logo"></span>
        <span>Dodam Board</span>
      </div>
      <div class="grow"></div>
      <div class="row" style="gap:8px;">
        <input id="apiBase" type="text" placeholder="API_BASE (예: http://localhost:8080)" style="width:260px">
        <button class="btn" id="saveCfg">저장</button>
      </div>
    </div>
    <div class="container" style="padding-top:0">
      <nav class="tabs" id="tabs">
        <a href="#boards" class="tab">Boards</a>
        <a href="#notices" class="tab">공지</a>
        <a href="#faqs" class="tab">FAQ</a>
        <a href="#inquiries" class="tab">문의</a>
        <a href="#posts" class="tab">커뮤니티</a>
        <a href="#events" class="tab">이벤트</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div id="view"></div>
    <div id="toast" class="hide"></div>
  </main>

  <footer class="container">
    <div class="row" style="justify-content: space-between;">
      <div>© Dodam • 정적 UI • 오프라인 모드 지원</div>
      <div class="muted">API 연결 시 CORS가 필요합니다. (README 참고)</div>
    </div>
  </footer>

  <script>
  // 간단한 상태
  const state = {
    apiBase: localStorage.getItem('DODAM_API_BASE') || '',
  };

  function $(sel, root=document){ return root.querySelector(sel); }
  function $all(sel, root=document){ return Array.from(root.querySelectorAll(sel)); }
  function setActiveTab(hash){
    $all('.tab').forEach(t => t.classList.toggle('active', t.getAttribute('href') === hash));
  }

  // API 호출 유틸
  async function api(path, opts={}){
    const base = state.apiBase.replace(/\/$/, '');
    if(!base){
      throw new Error('API_BASE가 설정되지 않았습니다. 좌측 상단 입력란에 설정 후 [저장] 클릭하세요.');
    }
    const res = await fetch(base + path, { headers:{ "Content-Type":"application/json" }, ...opts });
    if(!res.ok){
      const text = await res.text();
      throw new Error('API 오류: ' + res.status + ' ' + text);
    }
    const type = res.headers.get('content-type') || '';
    return type.includes('application/json') ? res.json() : res.text();
  }

  // 오프라인 샘플 데이터 (API 미연결 시)
  const sample = {
    boards: [
      { code:"NOTICE", name:"공지사항", description:"사이트 공지" },
      { code:"FAQ", name:"자주 묻는 질문", description:"FAQ 모음" },
      { code:"INQUIRY", name:"문의게시판", description:"1:1 문의" },
      { code:"EVENT", name:"이벤트", description:"프로모션" },
      { code:"COMMUNITY", name:"커뮤니티", description:"자유 게시판" },
    ],
    notices: [{ id:1, title:"서버 점검 안내", status:"PUBLISHED", createdAt:"2025-09-01" }],
    faqs: [{ id:1, question:"비밀번호를 잊어버렸어요", answer:"마이페이지에서 재설정 가능합니다." }],
    inquiries: [{ id:1, title:"배송 문의", content:"언제 발송되나요?", status:"PUBLISHED" }],
    posts: [{ id:1, title:"첫 글", author:"dodam", createdAt:"2025-09-07" }],
    events: [{ id:1, title:"가을 이벤트", period:"09.10 ~ 09.30" }]
  };

  function toast(msg, type="error"){
    const el = $("#toast");
    el.className = type === "error" ? "error" : "success";
    el.textContent = msg;
    el.classList.remove("hide");
    setTimeout(() => el.classList.add("hide"), 2500);
  }

  // 뷰 렌더러
  const views = {
    async boards(){
      setActiveTab("#boards");
      const v = $("#view");
      v.innerHTML = `
        <div class="card">
          <h1>Boards</h1>
          <p class="sub">현재 등록된 보드 목록(API: <span class="kbd">GET /api/boards</span>)</p>
          <div class="grid">
            <div>
              <table id="tbl">
                <thead><tr><th>코드</th><th>이름</th><th>설명</th></tr></thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="card">
              <h2>보드 단건 조회</h2>
              <div class="row">
                <input id="boardCode" type="text" placeholder="예: NOTICE">
                <button class="btn" id="btnFind">조회</button>
              </div>
              <pre id="boardOut" class="muted" style="white-space:pre-wrap;margin-top:10px;"></pre>
            </div>
          </div>
        </div>
      `;
      const tbody = $("#tbl tbody");
      try {
        const data = await api("/api/boards");
        (data || []).forEach(b => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td><span class="pill">${b.code}</span></td><td>${b.name||""}</td><td>${b.description||""}</td>`;
          tbody.appendChild(tr);
        });
      } catch(e){
        // 오프라인 샘플 사용
        sample.boards.forEach(b => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td><span class="pill">${b.code}</span></td><td>${b.name}</td><td>${b.description}</td>`;
          tbody.appendChild(tr);
        });
        toast("API 연결 실패: 샘플 데이터로 표시합니다.", "error");
      }
      $("#btnFind").onclick = async () => {
        const code = $("#boardCode").value.trim();
        if(!code) return toast("보드 코드를 입력하세요.");
        try{
          const one = await api(`/api/boards/${encodeURIComponent(code)}`);
          $("#boardOut").textContent = JSON.stringify(one, null, 2);
        }catch(e){
          $("#boardOut").textContent = e.message;
        }
      };
    },

    async notices(){
      setActiveTab("#notices");
      const v = $("#view");
      v.innerHTML = `
        <div class="card">
          <h1>공지</h1>
          <p class="sub">공지 목록(API 예시: <span class="kbd">GET /api/notices</span> 또는 프로젝트 매핑에 맞게 수정)</p>
          <div class="grid cols-2">
            <div class="card">
              <h2>목록</h2>
              <table><thead><tr><th>ID</th><th>제목</th><th>상태</th><th>생성일</th></tr></thead><tbody id="rows"></tbody></table>
            </div>
            <div class="card">
              <h2>등록</h2>
              <div class="row"><input id="ntTitle" type="text" placeholder="제목"></div>
              <div class="row"><textarea id="ntContent" placeholder="내용"></textarea></div>
              <div class="row"><select id="ntStatus"><option value="DRAFT">DRAFT</option><option value="PUBLISHED">PUBLISHED</option></select>
                <button class="btn primary" id="ntCreate">등록</button></div>
              <div id="ntMsg" class="muted" style="margin-top:8px;"></div>
            </div>
          </div>
        </div>
      `;
      const rows = $("#rows");
      try {
        const data = await api("/api/notices");
        (data || []).forEach(n => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${n.id||""}</td><td>${n.title||""}</td><td><span class="status ${n.status||"DRAFT"}">${n.status||"DRAFT"}</span></td><td>${n.createdAt||""}</td>`;
          rows.appendChild(tr);
        });
      } catch(e){
        sample.notices.forEach(n => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${n.id}</td><td>${n.title}</td><td><span class="status ${n.status}">${n.status}</span></td><td>${n.createdAt}</td>`;
          rows.appendChild(tr);
        });
        toast("API 연결 실패: 샘플 데이터로 표시합니다.");
      }
      $("#ntCreate").onclick = async () => {
        const payload = { title: $("#ntTitle").value.trim(), content: $("#ntContent").value.trim(), status: $("#ntStatus").value };
        if(!payload.title) return toast("제목을 입력하세요.");
        try {
          const res = await api("/api/notices", { method:"POST", body: JSON.stringify(payload) });
          $("#ntMsg").textContent = "등록 성공: " + JSON.stringify(res);
          $("#ntMsg").className = "success";
        } catch(e){
          $("#ntMsg").textContent = e.message;
          $("#ntMsg").className = "error";
        }
      };
    },

    async faqs(){
      setActiveTab("#faqs");
      const v = $("#view");
      v.innerHTML = `
        <div class="card">
          <h1>FAQ</h1>
          <p class="sub">FAQ 목록(API: <span class="kbd">GET /api/faqs</span>)</p>
          <div class="grid cols-2">
            <div class="card">
              <h2>목록</h2>
              <table><thead><tr><th>ID</th><th>질문</th><th>답변</th></tr></thead><tbody id="faqRows"></tbody></table>
            </div>
            <div class="card">
              <h2>등록</h2>
              <div class="row"><input id="fqQ" type="text" placeholder="질문"></div>
              <div class="row"><textarea id="fqA" placeholder="답변"></textarea></div>
              <div class="row"><button class="btn primary" id="fqCreate">등록</button></div>
              <div id="fqMsg" class="muted" style="margin-top:8px;"></div>
            </div>
          </div>
        </div>
      `;
      const rows = $("#faqRows");
      try {
        const data = await api("/api/faqs");
        (data || []).forEach(f => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${f.id||""}</td><td>${f.question||""}</td><td>${f.answer||""}</td>`;
          rows.appendChild(tr);
        });
      } catch(e){
        sample.faqs.forEach(f => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${f.id}</td><td>${f.question}</td><td>${f.answer}</td>`;
          rows.appendChild(tr);
        });
        toast("API 연결 실패: 샘플 데이터로 표시합니다.");
      }
      $("#fqCreate").onclick = async () => {
        const payload = { question: $("#fqQ").value.trim(), answer: $("#fqA").value.trim() };
        if(!payload.question) return toast("질문을 입력하세요.");
        try {
          const res = await api("/api/faqs", { method:"POST", body: JSON.stringify(payload) });
          $("#fqMsg").textContent = "등록 성공: " + JSON.stringify(res);
          $("#fqMsg").className = "success";
        } catch(e){
          $("#fqMsg").textContent = e.message;
          $("#fqMsg").className = "error";
        }
      };
    },

    async inquiries(){
      setActiveTab("#inquiries");
      const v = $("#view");
      v.innerHTML = `
        <div class="card">
          <h1>문의</h1>
          <p class="sub">문의 목록(API: <span class="kbd">GET /api/inquiries</span>)</p>
          <div class="grid cols-2">
            <div class="card">
              <h2>목록</h2>
              <table><thead><tr><th>ID</th><th>제목</th><th>내용</th><th>상태</th></tr></thead><tbody id="iqRows"></tbody></table>
            </div>
            <div class="card">
              <h2>등록</h2>
              <div class="row"><input id="iqTitle" type="text" placeholder="제목"></div>
              <div class="row"><textarea id="iqContent" placeholder="문의 내용"></textarea></div>
              <div class="row"><button class="btn primary" id="iqCreate">등록</button></div>
              <div id="iqMsg" class="muted" style="margin-top:8px;"></div>
            </div>
          </div>
        </div>
      `;
      const rows = $("#iqRows");
      try {
        const data = await api("/api/inquiries");
        (data || []).forEach(i => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${i.id||""}</td><td>${i.title||""}</td><td>${i.content||""}</td><td><span class="status ${i.status||"DRAFT"}">${i.status||"DRAFT"}</span></td>`;
          rows.appendChild(tr);
        });
      } catch(e){
        sample.inquiries.forEach(i => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${i.id}</td><td>${i.title}</td><td>${i.content||""}</td><td><span class="status ${i.status}">${i.status}</span></td>`;
          rows.appendChild(tr);
        });
        toast("API 연결 실패: 샘플 데이터로 표시합니다.");
      }
      $("#iqCreate").onclick = async () => {
        const payload = { title: $("#iqTitle").value.trim(), content: $("#iqContent").value.trim() };
        if(!payload.title) return toast("제목을 입력하세요.");
        try {
          const res = await api("/api/inquiries", { method:"POST", body: JSON.stringify(payload) });
          $("#iqMsg").textContent = "등록 성공: " + JSON.stringify(res);
          $("#iqMsg").className = "success";
        } catch(e){
          $("#iqMsg").textContent = e.message;
          $("#iqMsg").className = "error";
        }
      };
    },

    async posts(){
      setActiveTab("#posts");
      const v = $("#view");
      v.innerHTML = `
        <div class="card">
          <h1>커뮤니티</h1>
          <p class="sub">커뮤니티 글 목록(API: <span class="kbd">GET /api/posts</span>)</p>
          <div class="card">
            <table><thead><tr><th>ID</th><th>제목</th><th>작성자</th><th>생성일</th></tr></thead><tbody id="psRows"></tbody></table>
          </div>
        </div>
      `;
      const rows = $("#psRows");
      try {
        const data = await api("/api/posts");
        (data || []).forEach(p => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${p.id||""}</td><td>${p.title||p.slug||""}</td><td>${p.author||p.username||""}</td><td>${p.createdAt||""}</td>`;
          rows.appendChild(tr);
        });
      } catch(e){
        sample.posts.forEach(p => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${p.id}</td><td>${p.title}</td><td>${p.author}</td><td>${p.createdAt}</td>`;
          rows.appendChild(tr);
        });
        toast("API 연결 실패: 샘플 데이터로 표시합니다.");
      }
    },

    async events(){
      setActiveTab("#events");
      const v = $("#view");
      v.innerHTML = `
        <div class="card">
          <h1>이벤트</h1>
          <p class="sub">이벤트 목록(API 예시: <span class="kbd">GET /api/events</span>)</p>
          <div class="card">
            <table><thead><tr><th>ID</th><th>제목</th><th>기간</th></tr></thead><tbody id="evRows"></tbody></table>
          </div>
        </div>
      `;
      const rows = $("#evRows");
      try {
        const data = await api("/api/events");
        (data || []).forEach(e => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${e.id||""}</td><td>${e.title||""}</td><td>${e.period||""}</td>`;
          rows.appendChild(tr);
        });
      } catch(e){
        sample.events.forEach(x => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${x.id}</td><td>${x.title}</td><td>${x.period}</td>`;
          rows.appendChild(tr);
        });
        toast("API 연결 실패: 샘플 데이터로 표시합니다.");
      }
    },
  };

  async function router(){
    const hash = location.hash || "#boards";
    const page = hash.substring(1);
    const fn = views[page] || views.boards;
    $('#apiBase').value = state.apiBase;
    await fn();
  }

  window.addEventListener('hashchange', router);
  window.addEventListener('DOMContentLoaded', async () => {
    $('#apiBase').value = state.apiBase;
    $('#saveCfg').onclick = () => {
      state.apiBase = $('#apiBase').value.trim();
      localStorage.setItem('DODAM_API_BASE', state.apiBase);
      toast('API_BASE 저장 완료', 'success');
      router();
    };
    router();
  });
  </script>
</body>
</html>
